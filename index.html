<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe by ナイエム　エムディ</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Dark background inspired by the original image */
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <!-- Main Game Container -->
    <div id="game-container" class="bg-[#161b22] p-6 sm:p-10 rounded-xl shadow-2xl w-full max-w-sm border border-[#30363d]">

        <!-- Header and Status -->
        <header class="text-center mb-6">
            <h1 class="text-4xl font-bold text-white mb-2">
                <span class="text-indigo-400">Tic</span>-<span class="text-rose-400">Tac</span>-Toe
            </h1>
            <!-- Developer/Brand Tag -->
            <p class="text-sm text-gray-400 mb-4">Developed by <span class="font-semibold text-white">ナイエム　エムディ</span></p>

            <!-- Status/Message Box (Replaces alert()) -->
            <div id="status-message" class="h-10 flex items-center justify-center text-lg font-semibold rounded-lg transition-colors duration-300">
                <span class="text-gray-300">Player X's turn</span>
            </div>
        </header>

        <!-- Scoreboard -->
        <div class="flex justify-between items-center mb-6 bg-[#21262d] p-3 rounded-lg">
            <div class="text-center p-2 rounded-md w-1/2">
                <p class="text-xs uppercase tracking-wider text-indigo-400">Player X</p>
                <p id="score-x" class="text-2xl font-bold text-white">0</p>
            </div>
            <div class="text-center p-2 rounded-md w-1/2">
                <p class="text-xs uppercase tracking-wider text-rose-400">Player O</p>
                <p id="score-o" class="text-2xl font-bold text-white">0</p>
            </div>
        </div>

        <!-- Tic-Tac-Toe Grid -->
        <div id="game-grid" class="grid grid-cols-3 gap-3">
            <!-- Grid cells will be generated by JavaScript -->
        </div>

        <!-- Controls -->
        <div class="flex justify-center mt-8 space-x-4">
            <button id="reset-button" class="px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 active:scale-[.98]">
                Reset Board
            </button>
            <button id="new-game-button" class="px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-lg shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50 active:scale-[.98]">
                New Match (Reset Score)
            </button>
        </div>

    </div>

    <script>
        // --- Game Logic Start ---

        const grid = document.getElementById('game-grid');
        const statusMessage = document.getElementById('status-message');
        const resetButton = document.getElementById('reset-button');
        const newGameButton = document.getElementById('new-game-button');
        const scoreXElement = document.getElementById('score-x');
        const scoreOElement = document.getElementById('score-o');

        let board = Array(9).fill(null);
        let isXNext = true;
        let gameActive = true;
        let scoreX = 0;
        let scoreO = 0;

        // Winning combinations (indices of the board array)
        const winningConditions = [
            [0, 1, 2], [3, 4, 5], [6, 7, 8], // Rows
            [0, 3, 6], [1, 4, 7], [2, 5, 8], // Columns
            [0, 4, 8], [2, 4, 6]             // Diagonals
        ];

        /**
         * Renders the initial 3x3 grid cells and attaches event listeners.
         */
        const renderGrid = () => {
            grid.innerHTML = '';
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.id = `cell-${i}`;
                cell.classList.add(
                    'cell',
                    'h-24', 'w-full', 'rounded-lg', 'bg-[#21262d]',
                    'flex', 'items-center', 'justify-center',
                    'text-6xl', 'font-extrabold', 'cursor-pointer',
                    'transition-colors', 'duration-150', 'hover:bg-[#30363d]'
                );
                cell.dataset.index = i;
                cell.addEventListener('click', handleCellClick);
                grid.appendChild(cell);
            }
        };

        /**
         * Updates the status message displayed to the user.
         * @param {string} message The text content of the message.
         * @param {string} colorClass Tailwind class for text color.
         */
        const updateStatus = (message, colorClass = 'text-gray-300') => {
            statusMessage.innerHTML = `<span class="${colorClass}">${message}</span>`;
            // Clear any previous background color
            statusMessage.classList.remove('bg-indigo-900/50', 'bg-rose-900/50', 'bg-green-900/50', 'bg-gray-700/50');

            // Apply specific background for win/draw
            if (message.includes('Wins')) {
                statusMessage.classList.add('bg-green-900/50', 'text-green-300');
            } else if (message.includes('Draw')) {
                statusMessage.classList.add('bg-gray-700/50', 'text-gray-300');
            } else {
                // Apply a subtle background based on whose turn it is
                const turnClass = isXNext ? 'bg-indigo-900/50' : 'bg-rose-900/50';
                statusMessage.classList.add(turnClass);
            }
        };

        /**
         * Checks if the current board state results in a win or a draw.
         */
        const checkResult = () => {
            let roundWon = false;
            let winningLine = [];

            for (let i = 0; i < winningConditions.length; i++) {
                const [a, b, c] = winningConditions[i];
                if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                    roundWon = true;
                    winningLine = [a, b, c];
                    break;
                }
            }

            if (roundWon) {
                const winner = isXNext ? 'O' : 'X'; // Winner is the player who just played
                gameActive = false;

                // Update score
                if (winner === 'X') {
                    scoreX++;
                    scoreXElement.textContent = scoreX;
                    updateStatus(`Player X Wins!`, 'text-indigo-400');
                } else {
                    scoreO++;
                    scoreOElement.textContent = scoreO;
                    updateStatus(`Player O Wins!`, 'text-rose-400');
                }

                // Highlight winning line
                winningLine.forEach(index => {
                    document.getElementById(`cell-${index}`).classList.add('bg-green-500', 'text-white', 'scale-105');
                });

                return;
            }

            // Check for Draw
            if (!board.includes(null)) {
                gameActive = false;
                updateStatus(`It's a Draw!`, 'text-gray-300');
                // Highlight all cells subtly on a draw
                document.querySelectorAll('.cell').forEach(cell => {
                    cell.classList.add('bg-gray-700');
                });
                return;
            }

            // Continue game: Switch player and update status
            isXNext = !isXNext;
            updateStatus(`Player ${isXNext ? 'X' : 'O'}'s turn`);
        };

        /**
         * Handles the click event on a grid cell.
         * @param {Event} event The click event object.
         */
        const handleCellClick = (event) => {
            const clickedCell = event.target;
            const clickedCellIndex = parseInt(clickedCell.dataset.index);

            // Check if the cell is already played or the game is over
            if (board[clickedCellIndex] !== null || !gameActive) {
                return;
            }

            const currentPlayer = isXNext ? 'X' : 'O';

            // 1. Update the internal board state
            board[clickedCellIndex] = currentPlayer;

            // 2. Update the cell's appearance
            clickedCell.textContent = currentPlayer;
            clickedCell.classList.remove('hover:bg-[#30363d]');
            clickedCell.classList.add(
                currentPlayer === 'X' ? 'text-indigo-400' : 'text-rose-400',
                'bg-[#30363d]', // Lock the background when played
                'cursor-default'
            );

            // 3. Check for win/draw
            checkResult();
        };

        /**
         * Resets the board for a new round without changing scores.
         */
        const handleResetBoard = () => {
            board = Array(9).fill(null);
            gameActive = true;
            // The turn logic is determined by the previous game's winner or the default start
            
            // Re-render and re-attach listeners
            renderGrid();
            updateStatus(`Player ${isXNext ? 'X' : 'O'}'s turn`);
        };
        
        /**
         * Starts a brand new match, resetting the board and the scores.
         */
        const handleNewMatch = () => {
            scoreX = 0;
            scoreO = 0;
            scoreXElement.textContent = '0';
            scoreOElement.textContent = '0';
            isXNext = true; // Always start with X in a new match
            handleResetBoard();
            updateStatus(`Player X's turn`);
        };

        // --- Event Listeners and Initialization ---

        resetButton.addEventListener('click', handleResetBoard);
        newGameButton.addEventListener('click', handleNewMatch);

        // Initial setup
        renderGrid();
        updateStatus(`Player X's turn`);

    </script>
</body>
</html>